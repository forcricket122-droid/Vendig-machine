<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vending Machine</title>
<style>
    * { box-sizing: border-box; }
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        background: linear-gradient(135deg, #89f7fe, #66a6ff);
    }
    .container {
        max-width: 1200px;
        margin: auto;
        padding: 20px;
    }
    h1, h2 {
        text-align: center;
        color: #fff;
    }
    .products {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 20px;
        margin-top: 20px;
    }
    .product {
        background: #fff;
        padding: 10px;
        border-radius: 10px;
        text-align: center;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    .product img {
        width: 100%;
        height: 120px;
        object-fit: cover;
        margin-bottom: 10px;
        border-radius: 8px;
    }
    button {
        background: #66a6ff;
        color: #fff;
        border: none;
        padding: 8px 12px;
        border-radius: 5px;
        cursor: pointer;
        margin-top: 5px;
    }
    button:hover { background: #89f7fe; }
    .cart-page, .payment-page { display: none; }
    .cart-item {
        display: flex;
        justify-content: space-between;
        background: #fff;
        padding: 10px;
        margin-bottom: 10px;
        border-radius: 8px;
        flex-wrap: wrap;
        align-items: center;
    }
    .cart-item img {
        width: 50px;
        height: 50px;
        object-fit: cover;
        border-radius: 5px;
        margin-right: 10px;
    }
    input[type=number] { width: 50px; }
    .payment-section {
        background: #fff;
        padding: 20px;
        text-align: center;
        border-radius: 10px;
    }
    @media (max-width:600px){
        .cart-item { flex-direction: column; align-items: flex-start; }
        input[type=number] { width: 100%; margin-top:5px; }
    }
    input[type="file"]{
        margin-top: 5px;
    }
    .download-btn {
        display: block;
        margin: 20px auto;
        background: #ff7e5f;
        color: #fff;
        padding: 10px 20px;
        border-radius: 5px;
        text-decoration: none;
        text-align: center;
    }
</style>
</head>
<body>

<div class="container">
    <h1>Free Vending Machine</h1>

    <!-- Product Page -->
    <div class="products-page">
        <div class="products" id="products"></div>
        <a href="#" class="download-btn" id="downloadBtn">Download Page as HTML</a>
    </div>

    <!-- Cart Page -->
    <div class="cart-page" id="cartPage">
        <h2>Your Cart</h2>
        <div id="cartItems"></div>
        <h3>Total: ₹<span id="totalPrice">0</span></h3>
        <button onclick="goToPayment()">Buy</button>
        <button onclick="backToProducts()">Back</button>
    </div>

    <!-- Payment Page -->
    <div class="payment-page" id="paymentPage">
        <h2>Payment</h2>
        <div class="payment-section">
            <p>Scan this barcode to pay:</p>
            <img src="https://via.placeholder.com/150x150?text=Barcode" alt="Barcode">
            <p>UPI ID: vending@upi</p>
            <button onclick="backToProducts()">Done</button>
        </div>
    </div>

</div>

<script>
    const productsEl = document.getElementById('products');
    const cart = [];
    const totalPriceEl = document.getElementById('totalPrice');

    for(let i=1; i<=35; i++){
        const productDiv = document.createElement('div');
        productDiv.className = 'product';
        productDiv.innerHTML = `
            <img src="https://via.placeholder.com/150" alt="Product ${i}" id="img-${i}">
            <h4>Product ${i}</h4>
            <p>Price: ₹${i*10}</p>
            <input type="file" accept="image/*" onchange="previewImage(event, ${i})">
            <button onclick="addToCart(${i}, ${i*10}, 'Product ${i}')">Add to Cart</button>
        `;
        productsEl.appendChild(productDiv);
    }

    function previewImage(event, id){
        const img = document.getElementById('img-' + id);
        img.src = URL.createObjectURL(event.target.files[0]);
    }

    function addToCart(id, price, name){
        const existing = cart.find(i => i.id === id);
        const imgSrc = document.getElementById('img-' + id).src;
        if(existing){ existing.qty += 1; } 
        else { cart.push({id, name, price, qty:1, img: imgSrc}); }
        showCart();
    }

    function showCart(){
        document.querySelector('.products-page').style.display = 'none';
        document.getElementById('cartPage').style.display = 'block';

        const cartItemsEl = document.getElementById('cartItems');
        cartItemsEl.innerHTML = '';
        let total = 0;

        cart.forEach(item => {
            total += item.price * item.qty;
            const div = document.createElement('div');
            div.className = 'cart-item';
            div.innerHTML = `
                <img src='${item.img}' alt='${item.name}'>
                <span>${item.name}</span>
                <span>₹${item.price} x <input type="number" min="1" value="${item.qty}" onchange="updateQty(${item.id}, this.value)"></span>
            `;
            cartItemsEl.appendChild(div);
        });

        totalPriceEl.textContent = total;
    }

    function updateQty(id, qty){
        const item = cart.find(i => i.id === id);
        item.qty = parseInt(qty);
        showCart();
    }

    function goToPayment(){
        document.getElementById('cartPage').style.display = 'none';
        document.getElementById('paymentPage').style.display = 'block';
    }

    function backToProducts(){
        document.querySelector('.products-page').style.display = 'block';
        document.getElementById('cartPage').style.display = 'none';
        document.getElementById('paymentPage').style.display = 'none';
    }

    // Download HTML file functionality
    document.getElementById('downloadBtn').addEventListener('click', function(){
        const blob = new Blob([document.documentElement.outerHTML], {type:'text/html'});
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = 'vending_machine.html';
        link.click();
    });
</script>

</body>
</html>
